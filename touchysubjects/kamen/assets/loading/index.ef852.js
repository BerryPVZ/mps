window.__require=function a(e,t,n){function o(r,p){if(!t[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var c="function"==typeof __require&&__require;if(!p&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var l=t[r]={exports:{}};e[r][0].call(l.exports,function(a){return o(e[r][1][a]||a)},l,l.exports,a,e,t,n)}return t[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<n.length;r++)o(n[r]);return o}({pzaLoading:[function(a,e,t){"use strict";cc._RF.push(e,"27507cVVUpAoLFLVcGzTsNh","pzaLoading");var n,o=this&&this.__extends||(n=function(a,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,e){a.__proto__=e}||function(a,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])})(a,e)},function(a,e){function t(){this.constructor=a}n(a,e),a.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),i=this&&this.__decorate||function(a,e,t,n){var o,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(a,e,t,n);else for(var p=a.length-1;p>=0;p--)(o=a[p])&&(r=(i<3?o(r):i>3?o(e,t,r):o(e,t))||r);return i>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.registerHeadImgLoader=t.headImgExt=t.pzaLoading=void 0;var r=a("../Scripts/Achieve/pzaAchieveMgr"),p=a("../Scripts/Battle/Data/pzaPlantEnum"),s=a("../Scripts/Battle/pzaGameState"),c=a("../Scripts/BattlePass/pzaBattlePassTaskMgr"),l=a("../Scripts/Common/pzaBeltEquipConfig"),g=a("../Scripts/Common/pzaBeltSlotConfig"),d=a("../Scripts/Common/pzaDaySignConfig"),u=a("../Scripts/Common/pzaGameConfig"),z=a("../Scripts/Common/pzaGameManager"),f=a("../Scripts/Common/pzaGameMiniGame"),h=a("../Scripts/Common/pzaGamePartConfig"),m=a("../Scripts/Common/pzaGamePropConfig"),C=a("../Scripts/Common/pzaGameRecruitMgr"),S=a("../Scripts/Common/pzaGiftConfig"),v=a("../Scripts/Common/pzaLocalData"),y=a("../Scripts/Common/pzaShareGiftConfig"),L=a("../Scripts/Common/pzaSoundManager"),M=a("../Scripts/Common/pzaStatisticsMgr"),w=a("../Scripts/Common/pzaSurvivalConfig"),P=a("../Scripts/Common/pzaUIManager"),R=a("../Scripts/Common/pzaUtil"),D=a("../Scripts/Common/pzaZombieEnermyPartCfg"),B=a("../Scripts/Garden/pzaGardenMgr"),G=a("../Scripts/Load/pzaBundleObjectPool"),T=a("../Scripts/Load/pzaPreLoadManager"),V=a("../Scripts/LoginRewardView/pzaBeltHeroActivityMgr"),_=a("../Scripts/LoginRewardView/pzaLoginRewardMgr"),E=a("../Scripts/MonthSign/pzaMonthSignMgr"),b=a("../Scripts/Shop/pzaShopConfig"),I=a("../Scripts/Task/pzaTaskMgr"),N=a("../Scripts/View/Battle/pzaComicView"),A=a("../Scripts/View/Battle/pzaLoginView"),F=a("../Scripts/View/pzaWarningView"),U=a("../Scripts/newPlayerTask/pzaNewPlayTaskMgr"),k=(a("../Scripts/utils/Byte_analytics"),a("../Scripts/utils/pzaChannel")),O=a("../Scripts/utils/pzaChannelMy"),q=a("../Scripts/utils/pzaResMgr"),x=a("../Scripts/utils/pzakc"),j=a("../start/pzaBundleController"),W=cc._decorator,H=W.ccclass,Z=W.property,J=function(a){function e(){var e=null!==a&&a.apply(this,arguments)||this;return e.ageView=null,e.age12View=null,e.progressBar=null,e.proTag=null,e.ruanzhu=null,e.tip=null,e.loginView=null,e.topLogoSPF=[],e.bottomLogoSPF=[],e.loadPro=new Map,e.finishLoadCount=0,e.loadCom=!1,e.readDataCom=!1,e.navigateToMainStart=!1,e}return o(e,a),e.prototype.onLoad=function(){x.default.init(),R.pzaUtil.initGameSpeed(),Y(),x.default.eventReport("\u52a0\u8f7d\u5f00\u59cb"),this.loadCom=!1,this.readDataCom=!1,this.age12View.active="hw"==k.pzaChannel.instance().channel;var a=this.node.getChildByName("age");a.width=150,a.height=193;var e=this.node.getChildByName("topLogo").getComponent(cc.Sprite),t=this.node.getChildByName("bottomLogo").getComponent(cc.Sprite);e.node.active=!1,t.node.active=!1,this.channelInit(),this.ruanzhu.string=k.pzaChannel.instance().getRuanZhu(),this.tip.string="\u5f00\u59cb\u52a0\u8f7d\u573a\u666f.."},e.prototype.loadGameBundle=function(){var a=this;j.pzaBundleController.loadBundle(j.pzaBundleType.Game,function(e){null!=e?T.pzaPreLoadManager.MainResourceMap.forEach(function(e){G.pzaBundleObjectPool.preLoadResource(e,function(t,n){a.loadProgress(e,t/n)},function(){a.finishLoad(e)})}):console.error("\u52a0\u8f7dGame Bundle\u5f02\u5e38~")})},e.prototype.loadProgress=function(a,e){if(this.loadPro){var t=this.loadPro.get(a);if(!(null!=t&&t>e)){this.loadPro.set(a,e);var n=0;this.loadPro.forEach(function(a){n+=a}),n/=T.pzaPreLoadManager.MainResourceMap.size,this.progressBar.progress=n,this.proTag.x=this.progressBar.node.width*n}}},e.prototype.finishLoad=function(){var a=this;if(this.finishLoadCount++,this.finishLoadCount>=T.pzaPreLoadManager.MainResourceMap.size){this.loadCom=!0;var e=function(){a.readDataCom?a.navigateToMain():a.tip.string="\u573a\u666f\u52a0\u8f7d\u5b8c\u6bd5\uff0c\u52a0\u8f7d\u6570\u636e\u4e2d.."};"noAD"!=k.pzaChannel.instance().channel||k.pzaChannel.isConfRemote||k.pzaChannel.instance().getChannel().isWhite?e():(this.loginView.node.active=!0,this.loginView.nextLogic=e)}},e.prototype.navigateToMain=function(){var a=this;if(!this.navigateToMainStart){this.navigateToMainStart=!0;var e=0;"qq"==k.pzaChannel.instance().getChannel().channel&&(e=3e3),this.tip.string="\u5f00\u59cb\u8fdb\u5165\u573a\u666f",setTimeout(function(){v.pzaLocalData.serverTime?v.pzaLocalData.serverTime:Date.now();var e=function(){a.tip.string="\u8fdb\u5165\u573a\u666f\u4e2d..",v.pzaLocalData.isNewUser?x.default.eventReport("\u65b0\u589e\u7528\u6237\u52a0\u8f7d\u7ed3\u675f"):x.default.eventReport("\u52a0\u8f7d\u7ed3\u675f"),console.log("cc.director.loadScene"),cc.director.loadScene("main",function(){a.loadingFinish()})};1==v.pzaLocalData.data.curChapter&&1==v.pzaLocalData.data.curPart?G.pzaBundleObjectPool.preLoadResource(new T.pzaResourceDetail(T.pzaResourceUrl.COMIC_VIEW,T.pzaResourceType.Prefab),function(){},function(){e()}):e(),v.pzaLocalData.data.dataVersion!=v.pzaLocalData.data_verison&&(v.pzaLocalData.data.dataVersion=v.pzaLocalData.data_verison,v.pzaLocalData.addDirty("dataVersion")),x.default.newPlayerJudgeDay(),a.reissueRewards(),O.pzaChannelMy.SOPReport(O.reportAct.reportLoadingCompleted)},e)}},e.prototype.reissueRewards=function(){v.pzaLocalData.data.newPlayerTaskOver&&v.pzaLocalData.data.ownPlants.indexOf(p.pzaPlantEnum.GABY)<0&&(v.pzaLocalData.data.ownPlants.push(p.pzaPlantEnum.GABY),v.pzaLocalData.addDirty("ownPlants"))},e.prototype.loadingFinish=function(){l.pzaBeltEquipConfig.checkBeltBuff(),M.pzaStatisticsMgr.sendEvent("Loading",{name:"loading_step",value:3}),1==v.pzaLocalData.data.curChapter&&1==v.pzaLocalData.data.curPart?P.pzaUIManager.baseShowBoardUI(T.pzaResourceUrl.COMIC_VIEW,function(a){a.getComponent(N.pzaComicView).init(function(){z.pzaGameManager.preLoadAndStart(s.pzaGameMode.NORMAL,1,1)})}):P.pzaUIManager.baseShowBoardUI(T.pzaResourceUrl.HOME_SELECT_VIEW,null)},e.prototype.clickStart=function(){this.loadCom&&(k.pzaChannel.instance().getChannel().isReadRemoteUserData?(this.loadPlayerData(),this.initTDAnalytics(),this.initTTAnalytics()):this.readLocal())},e.prototype.clickShowAge=function(){this.ageView.active=!0},e.prototype.clickHideAge=function(){this.ageView.active=!1,this.age12View.active=!1},e.prototype.setView=function(){var a=this.node.getChildByName("topLogo").getComponent(cc.Sprite),e=this.node.getChildByName("bottomLogo").getComponent(cc.Sprite),t=this.node.parent.getChildByName("bg2").getChildByName("\u7248\u6743\u82f1\u6587");a.node.active=!0,e.node.active=!0,1==k.pzaChannel.instance().getCtrl("p3")?(a.spriteFrame=this.topLogoSPF[1],e.spriteFrame=this.bottomLogoSPF[1],t.active=!1):(a.spriteFrame=this.topLogoSPF[0],e.spriteFrame=this.bottomLogoSPF[0],t.active=!0)},e.prototype.channelInit=function(){var a=this;k.pzaChannel.getRemoteTime(),k.pzaChannel.isConfRemote&&(k.pzaChannel.instance().channel="noAD"),v.pzaLocalData.testData(),this.channelSwitchSet(),k.pzaChannel.instance().init(function(){a.setView(),k.pzaChannel.onLoadShowPrivacy(a.node,function(){a.loadGameBundle(),k.pzaChannel.instance().getChannel().isReadRemoteUserData?(a.loadPlayerData(),a.initTDAnalytics(),a.initTTAnalytics()):a.readLocal()}.bind(a))})},e.prototype.channelSwitchSet=function(){k.pzaChannel.isConfRemote?v.pzaLocalData.isShowGift=!0:("wx"==k.pzaChannel.instance().channel&&(v.pzaLocalData.isNoShareVideoSwap=!1),console.log("isNoShareVideoSwap",v.pzaLocalData.isNoShareVideoSwap))},e.prototype.loadPlayerData=function(){var a=this,e=k.pzaChannel.instance().getChannel();e.channelUserId?k.pzaChannel.loadFromRemote(e.channelUserId,function(t,n){if(t)return a.readLocal(),void(v.pzaLocalData.isShowSaveView=!0);var o=null;try{var i=v.pzaLocalData.readLocalData();null!=i&&""!=i&&"string"==typeof i&&(o=JSON.parse(i))}catch(r){console.error("loadFromRemote",r)}if(o&&!n)return a.readLocal(),void("wx"==e.channel?e.onLoginSuc():"tt"==e.channel?e.onLoginSuc():"my"==e.channel?e.onLoginSuc():"ks"==e.channel&&e.onLoginSuc());n||o||(v.pzaLocalData.isNewUser=1,x.default.eventReport("\u65b0\u589e\u7528\u6237\u52a0\u8f7d\u5f00\u59cb")),!n||null!=o&&n.saveTime<o.saveTime?(n||(n=new v.pzaLocalData),v.pzaLocalData.isNewUser?(console.log("\u68c0\u6d4b\u4e3a\u65b0\u8d26\u53f7,\u4f7f\u7528\u539f\u59cb\u6570\u636e!"),v.pzaLocalData.parseFromData(null)):o&&o.saveId!=n.saveId?(v.pzaLocalData.parseFromData(n),console.log("\u68c0\u6d4b\u5207\u6362\u8d26\u53f7,\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")):(v.pzaLocalData.parseFromData(o),console.log("\u4f7f\u7528\u672c\u5730\u6570\u636e!"))):(v.pzaLocalData.parseFromData(n),console.log("\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")),L.pzaSoundManager.playBgm(L.pzaBGMName.chahua_BGM),M.pzaStatisticsMgr.login(e.channelUserId),M.pzaStatisticsMgr.setUserProp(),M.pzaStatisticsMgr.sendEvent("login",{name:"is_new",value:v.pzaLocalData.isNewUser}),a.initConfig(),a.readDataCom=!0,a.loadCom?a.navigateToMain():a.tip.string="\u6570\u636e\u52a0\u8f7d\u5b8c\u6bd5\uff0c\u52a0\u8f7d\u573a\u666f\u4e2d..","wx"==e.channel?e.onLoginSuc():"tt"==e.channel?e.onLoginSuc():"my"==e.channel?e.onLoginSuc():"ks"==e.channel&&e.onLoginSuc(),x.default.judgeMonth()}):this.showWarning("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01",function(){"wx"==e.channel?e.wxLogin(function(){a.loadPlayerData()}):"my"==e.channel?e.myLogin(function(){a.loadPlayerData()}):"tt"==k.pzaChannel.instance().channel?e.ttLogin(function(){a.loadPlayerData()}):"ks"==k.pzaChannel.instance().channel?e.ksLogin(function(){a.loadPlayerData()}):"vivo"==k.pzaChannel.instance().channel?e.qgLogin(function(){a.loadPlayerData()}):"oppo"==k.pzaChannel.instance().channel?e.qgLogin(function(){a.loadPlayerData()}):"hw"==k.pzaChannel.instance().channel?e.qgLogin(function(){a.loadPlayerData()}):"qq"==k.pzaChannel.instance().channel?e.qqLogin(function(){a.loadPlayerData()}):"bl"==k.pzaChannel.instance().channel?e.blLogin(function(){a.loadPlayerData()}):"ry"==k.pzaChannel.instance().channel?e.qgLogin(function(){a.loadPlayerData()}):a.readLocal()},function(){a.readLocal()})},e.prototype.initConfig=function(){q.pzaResMgr.instance().loadConf(function(){if(h.pzaWaveConfig.initBaseWaveConfig(q.pzaResMgr.instance().getConf("a2")),u.pzaGameConfig.initPlantConfig(q.pzaResMgr.instance().getConf("a3")),u.pzaGameConfig.initZombieConfig(q.pzaResMgr.instance().getConf("a4")),h.pzaGamePartConfig.initPartConfig(q.pzaResMgr.instance().getConf("a5")),b.pzaShopConfig.initShopConfig(q.pzaResMgr.instance().getConf("a6")),m.pzaGamePropConfig.initPropConfig(q.pzaResMgr.instance().getConf("a7")),l.pzaBeltEquipConfig.initConfig(q.pzaResMgr.instance().getConf("a8")),B.default.instance().init(q.pzaResMgr.instance().getConf("a10")),r.default.instance().init(q.pzaResMgr.instance().getConf("a9")),w.pzaSurvivalConfig.initSurvivalConfig(q.pzaResMgr.instance().getConf("a15")),D.pzaZombieEnermyPartCfg.initPartConfig(q.pzaResMgr.instance().getConf("a11")),q.pzaResMgr.instance().getConf("a12")&&(v.pzaLocalData.vaseAllTrophy=q.pzaResMgr.instance().getConf("a12").length-1),D.pzaZombieEnermyPartCfg.initPuffFloat(q.pzaResMgr.instance().getConf("a13")),y.pzaShareGiftConfig.initGiftConfig(q.pzaResMgr.instance().getConf("a18")),g.pzaBeltSlotConfig.initConfig(q.pzaResMgr.instance().getConf("a17")),d.pzaDaySignConfig.initPropConfig(q.pzaResMgr.instance().getConf("a19")),E.default.instance().init(q.pzaResMgr.instance().getConf("a20")),E.default.instance().resetInit(q.pzaResMgr.instance().getConf("a20")),S.pzaGiftConfig.initPropConfig(q.pzaResMgr.instance().getConf("a22")),c.default.instance().init(q.pzaResMgr.instance().getConf("a25")),U.default.instance().initNewPlayerTask(q.pzaResMgr.instance().getConf("a26")),U.default.instance().initStepRewardTask(q.pzaResMgr.instance().getConf("a27")),_.default.instance().initLoginActivityRewards(q.pzaResMgr.instance().getConf("a28")),_.default.instance().initPieceSummon(q.pzaResMgr.instance().getConf("a29")),_.default.instance().initRiderFallPieceRate(q.pzaResMgr.instance().getConf("a30")),_.default.instance().initRiderFallTask(q.pzaResMgr.instance().getConf("a31")),V.default.instance().initAllReward(q.pzaResMgr.instance().getConf("a7")),V.default.instance().initActivityReward(q.pzaResMgr.instance().getConf("a32")),C.pzaGameRecruitMgr.instance().initRecruitDrawMap(q.pzaResMgr.instance().getConf("a35")),"wx"==k.pzaChannel.instance().channel){var a=k.pzaChannel.instance().getChannel();a.getAbTest("expt_1720752823"),a.getPowerGiftAbTest("expt_1723794382")}z.pzaGameManager.getGame(s.pzaGameMode.MINIGAME,f.pzaGameMiniGame),I.default.instance().init()})},e.prototype.readLocal=function(){try{var a=v.pzaLocalData.readLocalData();if(null!=a&&""!=a&&"string"==typeof a){var e=JSON.parse(a);v.pzaLocalData.parseFromData(e)}else v.pzaLocalData.parseFromData(null);this.initConfig()}catch(t){console.error(t)}L.pzaSoundManager.playBgm(L.pzaBGMName.chahua_BGM),this.readDataCom=!0,this.loadCom?this.navigateToMain():this.tip.string="\u6570\u636e\u52a0\u8f7d\u5b8c\u6bd5\uff0c\u52a0\u8f7d\u573a\u666f\u4e2d..",x.default.judgeMonth()},e.prototype.showWarning=function(a,e,t){var n=this;G.pzaBundleObjectPool.requestInstantByUrl(T.pzaResourceUrl.WARNING_VIEW,!1,function(o,i){if(null==o&&null!=i){i.setParent(n.node);var r=i&&i.getComponent(F.pzaWarningView);r&&r.show(a,"\u786e\u5b9a","\u53d6\u6d88",e,t)}else console.error(o)})},e.prototype.initTDAnalytics=function(){if("oppo"!=k.pzaChannel.instance().channel&&"vivo"!=k.pzaChannel.instance().channel&&"qq"!=k.pzaChannel.instance().channel){var a="https://tga-data-upload.hrgame.com.cn";console.log("tga report url ",a);var e={appId:"aa59e60bdd334a1a9ac24f71150fed95",serverUrl:a,autoTrack:{appShow:!0,appHide:!0},enableLog:!1};M.pzaStatisticsMgr.init(e)}},e.prototype.initTTAnalytics=function(){k.pzaChannel.instance().getChannel().channelUserId},i([Z({displayName:"\u9002\u9f84\u63d0\u793a\u8282\u70b9",type:cc.Node})],e.prototype,"ageView",void 0),i([Z({displayName:"\u9002\u9f8412+\u63d0\u793a\u8282\u70b9",type:cc.Node})],e.prototype,"age12View",void 0),i([Z({displayName:"\u8fdb\u5ea6",type:cc.ProgressBar})],e.prototype,"progressBar",void 0),i([Z({displayName:"\u8fdb\u5ea6\u6807\u7b7e",type:cc.Node})],e.prototype,"proTag",void 0),i([Z({displayName:"\u8f6f\u8457",type:cc.Label})],e.prototype,"ruanzhu",void 0),i([Z(cc.Label)],e.prototype,"tip",void 0),i([Z({type:A.pzaLoginView})],e.prototype,"loginView",void 0),i([Z({type:[cc.SpriteFrame]})],e.prototype,"topLogoSPF",void 0),i([Z({type:[cc.SpriteFrame]})],e.prototype,"bottomLogoSPF",void 0),i([H],e)}(cc.Component);function Y(){cc.assetManager.downloader.register(t.headImgExt,function(a,e,t){t(null,a)}),cc.assetManager.parser.register(t.headImgExt,K),cc.assetManager.factory.register(t.headImgExt,function(a,e,t,n){var o=null,i=null;try{(o=new cc.Texture2D)._uuid=a,o._nativeUrl=a,o._nativeAsset=e}catch(r){i=r}n&&n(i,o)})}function K(a,e,t){var n=new Image;function o(){n.removeEventListener("load",o),n.removeEventListener("error",i),t&&t(null,n)}function i(){n.removeEventListener("load",o),n.removeEventListener("error",i),t&&t(new Error(a))}return"file:"!==window.location.protocol&&(n.crossOrigin="anonymous"),n.addEventListener("load",o),n.addEventListener("error",i),n.src=a,n}t.pzaLoading=J,t.headImgExt=".head",t.registerHeadImgLoader=Y,cc._RF.pop()},{"../Scripts/Achieve/pzaAchieveMgr":void 0,"../Scripts/Battle/Data/pzaPlantEnum":void 0,"../Scripts/Battle/pzaGameState":void 0,"../Scripts/BattlePass/pzaBattlePassTaskMgr":void 0,"../Scripts/Common/pzaBeltEquipConfig":void 0,"../Scripts/Common/pzaBeltSlotConfig":void 0,"../Scripts/Common/pzaDaySignConfig":void 0,"../Scripts/Common/pzaGameConfig":void 0,"../Scripts/Common/pzaGameManager":void 0,"../Scripts/Common/pzaGameMiniGame":void 0,"../Scripts/Common/pzaGamePartConfig":void 0,"../Scripts/Common/pzaGamePropConfig":void 0,"../Scripts/Common/pzaGameRecruitMgr":void 0,"../Scripts/Common/pzaGiftConfig":void 0,"../Scripts/Common/pzaLocalData":void 0,"../Scripts/Common/pzaShareGiftConfig":void 0,"../Scripts/Common/pzaSoundManager":void 0,"../Scripts/Common/pzaStatisticsMgr":void 0,"../Scripts/Common/pzaSurvivalConfig":void 0,"../Scripts/Common/pzaUIManager":void 0,"../Scripts/Common/pzaUtil":void 0,"../Scripts/Common/pzaZombieEnermyPartCfg":void 0,"../Scripts/Garden/pzaGardenMgr":void 0,"../Scripts/Load/pzaBundleObjectPool":void 0,"../Scripts/Load/pzaPreLoadManager":void 0,"../Scripts/LoginRewardView/pzaBeltHeroActivityMgr":void 0,"../Scripts/LoginRewardView/pzaLoginRewardMgr":void 0,"../Scripts/MonthSign/pzaMonthSignMgr":void 0,"../Scripts/Shop/pzaShopConfig":void 0,"../Scripts/Task/pzaTaskMgr":void 0,"../Scripts/View/Battle/pzaComicView":void 0,"../Scripts/View/Battle/pzaLoginView":void 0,"../Scripts/View/pzaWarningView":void 0,"../Scripts/newPlayerTask/pzaNewPlayTaskMgr":void 0,"../Scripts/utils/Byte_analytics":void 0,"../Scripts/utils/pzaChannel":void 0,"../Scripts/utils/pzaChannelMy":void 0,"../Scripts/utils/pzaResMgr":void 0,"../Scripts/utils/pzakc":void 0,"../start/pzaBundleController":void 0}]},{},["pzaLoading"]);