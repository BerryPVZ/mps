window.__require=function a(n,t,e){function o(r,s){if(!t[r]){if(!n[r]){var p=r.split("/");if(p=p[p.length-1],!n[p]){var c="function"==typeof __require&&__require;if(!s&&c)return c(p,!0);if(i)return i(p,!0);throw new Error("Cannot find module '"+r+"'")}r=p}var l=t[r]={exports:{}};n[r][0].call(l.exports,function(a){return o(n[r][1][a]||a)},l,l.exports,a,n,t,e)}return t[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<e.length;r++)o(e[r]);return o}({pzaLoading:[function(a,n,t){"use strict";cc._RF.push(n,"27507cVVUpAoLFLVcGzTsNh","pzaLoading");var e,o=this&&this.__extends||(e=function(a,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t])})(a,n)},function(a,n){function t(){this.constructor=a}e(a,n),a.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),i=this&&this.__decorate||function(a,n,t,e){var o,i=arguments.length,r=i<3?n:null===e?e=Object.getOwnPropertyDescriptor(n,t):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(a,n,t,e);else for(var s=a.length-1;s>=0;s--)(o=a[s])&&(r=(i<3?o(r):i>3?o(n,t,r):o(n,t))||r);return i>3&&r&&Object.defineProperty(n,t,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.registerHeadImgLoader=t.headImgExt=t.pzaLoading=void 0;var r=a("../Scripts/Achieve/pzaAchieveMgr"),s=a("../Scripts/BattlePass/pzaBattlePassMgr"),p=a("../Scripts/BattlePass/pzaBattlePassTaskMgr"),c=a("../Scripts/Common/pzaCarConfig"),l=a("../Scripts/Common/pzaChallengePartConfig"),g=a("../Scripts/Common/pzaDaySignConfig"),d=a("../Scripts/Common/pzaEndlessPartConfig"),f=a("../Scripts/Common/pzaGameConfig"),u=a("../Scripts/Common/pzaGameOldPartConfig"),h=a("../Scripts/Common/pzaGamePartConfig"),z=a("../Scripts/Common/pzaGamePropConfig"),C=a("../Scripts/Common/pzaGiftConfig"),m=a("../Scripts/Common/pzaLocalData"),S=a("../Scripts/Common/pzaOperationMgr"),v=a("../Scripts/Common/pzaShareGiftConfig"),y=a("../Scripts/Common/pzaShovelConfig"),M=a("../Scripts/Common/pzaSoundManager"),L=a("../Scripts/Common/pzaStatisticsMgr"),P=a("../Scripts/Common/pzaUIManager"),w=a("../Scripts/Common/pzaUtil"),D=a("../Scripts/Common/pzaWorldEventManager"),R=a("../Scripts/Common/pzaZjGameConfig"),T=a("../Scripts/Load/pzaBundleObjectPool"),_=a("../Scripts/Load/pzaPreLoadManager"),B=a("../Scripts/MonthSign/pzaMonthSignMgr"),E=a("../Scripts/Shop/pzaShopConfig"),N=a("../Scripts/Task/pzaTaskMgr"),G=a("../Scripts/View/Battle/pzaLoginView"),V=a("../Scripts/View/pzaWarningView"),I=a("../Scripts/newPlayerTask/pzaNewPlayTaskMgr"),O=a("../Scripts/utils/pzaChannel"),b=a("../Scripts/utils/pzaChannelMy"),U=a("../Scripts/utils/pzaResMgr"),k=a("../Scripts/utils/pzakc"),A=a("../start/pzaBundleController"),j=cc._decorator,q=j.ccclass,x=j.property,W=function(a){function n(){var n=null!==a&&a.apply(this,arguments)||this;return n.loginBtn=null,n.ageView=null,n.age12View=null,n.progressBar=null,n.proTag=null,n.ruanzhu=null,n.tip=null,n.pvzbg=null,n.noticeBtn=null,n.loginView=null,n.loadPro=new Map,n.finishLoadCount=0,n.loadCom=!1,n.readDataCom=!1,n.canShowStart=!1,n.navigateToMainStart=!1,n}return o(n,a),n.prototype.onLoad=function(){k.default.init(),w.pzaUtil.initGameSpeed(),F(),this.loadCom=!1,this.readDataCom=!1,this.age12View.active="hw"==O.pzaChannel.instance().channel,this.noticeBtn.active=!1,this.channelInit(),this.ruanzhu.string=O.pzaChannel.instance().getRuanZhu(),cc.tween(this.proTag).to(1,{angle:-360},{onUpdate:function(a){a.angle<=-360&&(a.angle=0)}}).repeatForever().start()},n.prototype.onEnable=function(){this.loginBtn.on(cc.Node.EventType.TOUCH_START,this.clickStart,this)},n.prototype.onDisable=function(){this.loginBtn.off(cc.Node.EventType.TOUCH_START,this.clickStart,this)},n.prototype.loadGame=function(){var a=this;A.pzaBundleController.loadBundle(A.pzaBundleType.Game,function(n){null!=n?(L.pzaStatisticsMgr.sendEvent(D.SsEventName.loading,{name:"loading_step",value:2}),O.pzaChannel.instance().doAction(6,["vivo"]),_.pzaPreLoadManager.MainResourceMap.forEach(function(n){T.pzaBundleObjectPool.preLoadResource(n,function(t,e){a.loadProgress(n,t/e)},function(){a.finishLoad(n)})})):console.error("\u52a0\u8f7dGame Bundle\u5f02\u5e38~")})},n.prototype.loadProgress=function(a,n){if(this.loadPro){var t=this.loadPro.get(a);if(!(null!=t&&t>n)){this.loadPro.set(a,n);var e=0;this.loadPro.forEach(function(a){e+=a}),e/=_.pzaPreLoadManager.MainResourceMap.size,this.progressBar.progress=e,this.proTag.x=this.progressBar.node.width*e}}},n.prototype.finishLoad=function(){var a=this;if(this.finishLoadCount++,this.finishLoadCount>=_.pzaPreLoadManager.MainResourceMap.size){if(this.loadCom=!0,this.readDataCom)return L.pzaStatisticsMgr.sendEvent(D.SsEventName.loading,{name:"loading_step",value:3}),void this.navigateToMain();this.scheduleOnce(function(){"hw"!=O.pzaChannel.instance().channel&&(a.canShowStart=!0,a.tip.string="\u70b9\u51fb\u5f00\u59cb\u6e38\u620f")},3)}},n.prototype.navigateToMain=function(a){if(void 0===a&&(a=0),!this.navigateToMainStart){this.navigateToMainStart=!0;var n=a;"qq"==O.pzaChannel.instance().getChannel().channel&&(n=3e3),setTimeout(function(){m.pzaLocalData.serverTime?m.pzaLocalData.serverTime:Date.now(),console.log("cc.director.loadScene"),cc.director.loadScene("main",function(){m.pzaLocalData.data.dayJoinCnt++,m.pzaLocalData.data.onceShowSignView=!1,m.pzaLocalData.addDirty("dayJoinCnt","onceShowSignView"),P.pzaUIManager.baseShowBoardUI(_.pzaResourceUrl.HOME_SELECT_VIEW,null),S.pzaOperationMgr.checkBuyResult(function(){})}),m.pzaLocalData.data.dataVersion!=m.pzaLocalData.data_verison&&(m.pzaLocalData.data.dataVersion=m.pzaLocalData.data_verison,m.pzaLocalData.addDirty("dataVersion")),k.default.newPlayerJudgeDay(),b.pzaChannelMy.SOPReport(b.reportAct.reportLoadingCompleted)},n)}},n.prototype.clickStart=function(){if(this.loadCom&&this.canShowStart)if(O.pzaChannel.instance().getChannel().isReadRemoteUserData){this.initTDAnalytics(),this.initTTAnalytics();var a=0==k.default.getData("isNew",0);L.pzaStatisticsMgr.login(O.pzaChannel.instance().getChannel().channelUserId),L.pzaStatisticsMgr.setUserProp(a),L.pzaStatisticsMgr.setPubProp(a),L.pzaStatisticsMgr.sendEvent(D.SsEventName.login,{name:"is_new",value:a}),L.pzaStatisticsMgr.sendEvent(D.SsEventName.loading,{name:"loading_step",value:1}),this.loadPlayerData()}else this.readLocal()},n.prototype.clickShowAge=function(){this.ageView.active=!0},n.prototype.clickHideAge=function(){this.ageView.active=!1,this.age12View.active=!1},n.prototype.setView=function(){},n.prototype.channelInit=function(){var a=this;O.pzaChannel.getRemoteTime(),O.pzaChannel.isConfRemote&&(O.pzaChannel.instance().channel="noAD"),m.pzaLocalData.testData(),this.channelSwitchSet(),O.pzaChannel.instance().init(function(){a.setView(),O.pzaChannel.onLoadShowPrivacy(a.node,function(){O.pzaChannel.checkArea(function(n){if(n)if(O.pzaChannel.instance().getChannel().isReadRemoteUserData){a.initTDAnalytics(),a.initTTAnalytics();var t=0==k.default.getData("isNew",0);L.pzaStatisticsMgr.login(O.pzaChannel.instance().getChannel().channelUserId),L.pzaStatisticsMgr.setUserProp(t),L.pzaStatisticsMgr.setPubProp(t),L.pzaStatisticsMgr.sendEvent(D.SsEventName.login,{name:"is_new",value:t}),L.pzaStatisticsMgr.sendEvent(D.SsEventName.loading,{name:"loading_step",value:1}),a.loadPlayerData(),a.loadGame()}else a.loadGame(),a.readLocal()})}.bind(a))})},n.prototype.channelSwitchSet=function(){O.pzaChannel.isConfRemote&&(m.pzaLocalData.isShowGift=!0)},n.prototype.loadPlayerData=function(){var a=this,n=O.pzaChannel.instance().getChannel();n.channelUserId?O.pzaChannel.loadFromRemote(n.channelUserId,function(t,e){if(t)return a.readLocal(),void(m.pzaLocalData.isShowSaveView=!0);var o=null;try{var i=m.pzaLocalData.readLocalData();null!=i&&""!=i&&"string"==typeof i&&(o=JSON.parse(i))}catch(r){console.error("loadFromRemote",r)}if(o&&!e)return a.readLocal(),void("wx"==n.channel?n.onLoginSuc():"tt"==n.channel?n.onLoginSuc():"my"==n.channel?n.onLoginSuc():"ks"==n.channel&&n.onLoginSuc());e||o||(m.pzaLocalData.isNewUser=1),!e||null!=o&&e.saveTime<o.saveTime?(e||(e=new m.pzaLocalData),m.pzaLocalData.isNewUser?console.log("\u68c0\u6d4b\u4e3a\u65b0\u8d26\u53f7,\u4f7f\u7528\u539f\u59cb\u6570\u636e!"):o&&o.saveId!=e.saveId?(m.pzaLocalData.parseFromData(e),console.log("\u68c0\u6d4b\u5207\u6362\u8d26\u53f7,\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")):(m.pzaLocalData.parseFromData(o),console.log("\u4f7f\u7528\u672c\u5730\u6570\u636e!"))):(m.pzaLocalData.parseFromData(e),console.log("\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")),M.pzaSoundManager.playBgm(M.pzaBGMName.LOADING),a.initConfig(),a.readDataCom=!0,a.loadCom&&a.navigateToMain(),"wx"==n.channel?n.onLoginSuc():"tt"==n.channel?n.onLoginSuc():"my"==n.channel?n.onLoginSuc():"ks"==n.channel&&n.onLoginSuc(),k.default.judgeMonth()}):this.showWarning("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01",function(){"wx"==n.channel?n.wxLogin(function(){a.loadPlayerData()}):"my"==n.channel?n.myLogin(function(){a.loadPlayerData()}):"tt"==O.pzaChannel.instance().channel?n.ttLogin(function(){a.loadPlayerData()}):"ks"==O.pzaChannel.instance().channel?n.ksLogin(function(){a.loadPlayerData()}):"vivo"==O.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"oppo"==O.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"hw"==O.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"qq"==O.pzaChannel.instance().channel?n.qqLogin(function(){a.loadPlayerData()}):"bl"==O.pzaChannel.instance().channel?n.blLogin(function(){a.loadPlayerData()}):a.readLocal()},function(){a.readLocal()})},n.prototype.initConfig=function(){U.pzaResMgr.instance().loadConf(function(){h.pzaWaveConfig.initBaseWaveConfig(U.pzaResMgr.instance().getConf("a2")),f.pzaGameConfig.initPlantConfig(U.pzaResMgr.instance().getConf("a3")),f.pzaGameConfig.initZombieConfig(U.pzaResMgr.instance().getConf("a4")),R.pzaZjGameConfig.initZjPlantZombie(),h.pzaGamePartConfig.initPartConfig(U.pzaResMgr.instance().getConf("a7"));var a=U.pzaResMgr.instance().getConf("a8");E.pzaShopConfig.initShopConfig(a),r.default.instance().init(U.pzaResMgr.instance().getConf("a9")),l.pzaChallengePartConfig.initPartConfig(U.pzaResMgr.instance().getConf("a10")),d.pzaEndlessPartConfig.initPartConfig(U.pzaResMgr.instance().getConf("a11")),u.pzaGameOldPartConfig.initPartConfig(U.pzaResMgr.instance().getConf("a12")),z.pzaGamePropConfig.initPropConfig(U.pzaResMgr.instance().getConf("a16")),y.pzaShovelConfig.initShovelConfig(U.pzaResMgr.instance().getConf("a17")),c.pzaCarConfig.initCarConfig(U.pzaResMgr.instance().getConf("a18")),g.pzaDaySignConfig.initPropConfig(U.pzaResMgr.instance().getConf("a19")),B.default.instance().init(U.pzaResMgr.instance().getConf("a20")),v.pzaShareGiftConfig.initGiftConfig(U.pzaResMgr.instance().getConf("a21")),s.default.instance().normalRewardInit(U.pzaResMgr.instance().getConf("a13")),s.default.instance().highRewardInit(U.pzaResMgr.instance().getConf("a14")),p.default.instance().init(U.pzaResMgr.instance().getConf("a22")),C.pzaGiftConfig.initPropConfig(U.pzaResMgr.instance().getConf("a23")),I.default.instance().initNewPlayerTask(U.pzaResMgr.instance().getConf("a24")),I.default.instance().initStepRewardTask(U.pzaResMgr.instance().getConf("a25")),N.default.instance().init()})},n.prototype.readLocal=function(){try{var a=m.pzaLocalData.readLocalData();if(null!=a&&""!=a&&"string"==typeof a){var n=JSON.parse(a);m.pzaLocalData.parseFromData(n)}this.initConfig()}catch(t){console.error(t)}M.pzaSoundManager.playBgm(M.pzaBGMName.LOADING),this.readDataCom=!0,this.loadCom&&this.navigateToMain(1e3),k.default.judgeMonth()},n.prototype.showWarning=function(a,n,t){var e=this;T.pzaBundleObjectPool.requestInstantByUrl(_.pzaResourceUrl.WARNING_VIEW,!1,function(o,i){if(null==o&&null!=i){i.setParent(e.node);var r=i&&i.getComponent(V.pzaWarningView);r&&r.show(a,"\u786e\u5b9a","\u53d6\u6d88",n,t)}else console.error(o)})},n.prototype.initTDAnalytics=function(){L.pzaStatisticsMgr.init({appId:"3f921f99d3044d3bb01d4d749ce27707",serverUrl:"https://ss.gamejym.com",autoTrack:{appShow:!0,appHide:!0},enableLog:!1})},n.prototype.initTTAnalytics=function(){},n.prototype.clickNoticeBtn=function(){var a=this;T.pzaBundleObjectPool.requestInstantByUrl(_.pzaResourceUrl.NOTICE_VIEW,!1,function(n,t){null==n&&null!=t?t.setParent(a.node):console.error(n)})},i([x(cc.Node)],n.prototype,"loginBtn",void 0),i([x({displayName:"\u9002\u9f84\u63d0\u793a\u8282\u70b9",type:cc.Node})],n.prototype,"ageView",void 0),i([x({displayName:"\u9002\u9f8412+\u63d0\u793a\u8282\u70b9",type:cc.Node})],n.prototype,"age12View",void 0),i([x({displayName:"\u8fdb\u5ea6",type:cc.ProgressBar})],n.prototype,"progressBar",void 0),i([x({displayName:"\u8fdb\u5ea6\u6807\u7b7e",type:cc.Node})],n.prototype,"proTag",void 0),i([x({displayName:"\u8f6f\u8457",type:cc.Label})],n.prototype,"ruanzhu",void 0),i([x(cc.Label)],n.prototype,"tip",void 0),i([x({type:cc.Node})],n.prototype,"pvzbg",void 0),i([x({type:cc.Node})],n.prototype,"noticeBtn",void 0),i([x({type:G.pzaLoginView})],n.prototype,"loginView",void 0),i([q],n)}(cc.Component);function F(){cc.assetManager.downloader.register(t.headImgExt,function(a,n,t){t(null,a)}),cc.assetManager.parser.register(t.headImgExt,H),cc.assetManager.factory.register(t.headImgExt,function(a,n,t,e){var o=null,i=null;try{(o=new cc.Texture2D)._uuid=a,o._nativeUrl=a,o._nativeAsset=n}catch(r){i=r}e&&e(i,o)})}function H(a,n,t){var e=new Image;function o(){e.removeEventListener("load",o),e.removeEventListener("error",i),t&&t(null,e)}function i(){e.removeEventListener("load",o),e.removeEventListener("error",i),t&&t(new Error(a))}return"file:"!==window.location.protocol&&(e.crossOrigin="anonymous"),e.addEventListener("load",o),e.addEventListener("error",i),e.src=a,e}t.pzaLoading=W,t.headImgExt=".head",t.registerHeadImgLoader=F,cc._RF.pop()},{"../Scripts/Achieve/pzaAchieveMgr":void 0,"../Scripts/BattlePass/pzaBattlePassMgr":void 0,"../Scripts/BattlePass/pzaBattlePassTaskMgr":void 0,"../Scripts/Common/pzaCarConfig":void 0,"../Scripts/Common/pzaChallengePartConfig":void 0,"../Scripts/Common/pzaDaySignConfig":void 0,"../Scripts/Common/pzaEndlessPartConfig":void 0,"../Scripts/Common/pzaGameConfig":void 0,"../Scripts/Common/pzaGameOldPartConfig":void 0,"../Scripts/Common/pzaGamePartConfig":void 0,"../Scripts/Common/pzaGamePropConfig":void 0,"../Scripts/Common/pzaGiftConfig":void 0,"../Scripts/Common/pzaLocalData":void 0,"../Scripts/Common/pzaOperationMgr":void 0,"../Scripts/Common/pzaShareGiftConfig":void 0,"../Scripts/Common/pzaShovelConfig":void 0,"../Scripts/Common/pzaSoundManager":void 0,"../Scripts/Common/pzaStatisticsMgr":void 0,"../Scripts/Common/pzaUIManager":void 0,"../Scripts/Common/pzaUtil":void 0,"../Scripts/Common/pzaWorldEventManager":void 0,"../Scripts/Common/pzaZjGameConfig":void 0,"../Scripts/Load/pzaBundleObjectPool":void 0,"../Scripts/Load/pzaPreLoadManager":void 0,"../Scripts/MonthSign/pzaMonthSignMgr":void 0,"../Scripts/Shop/pzaShopConfig":void 0,"../Scripts/Task/pzaTaskMgr":void 0,"../Scripts/View/Battle/pzaLoginView":void 0,"../Scripts/View/pzaWarningView":void 0,"../Scripts/newPlayerTask/pzaNewPlayTaskMgr":void 0,"../Scripts/utils/pzaChannel":void 0,"../Scripts/utils/pzaChannelMy":void 0,"../Scripts/utils/pzaResMgr":void 0,"../Scripts/utils/pzakc":void 0,"../start/pzaBundleController":void 0}]},{},["pzaLoading"]);